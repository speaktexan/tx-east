import{d as y}from"./player.DQDFRdEJ.js";import{$ as i}from"./store.DE-WIDqh.js";const h=s=>{s.classList.add("hidden"),s.classList.remove("flex")},m=s=>{s.classList.add("flex"),s.classList.remove("hidden")},b="!bg-blue-hover",g=document.querySelectorAll(".playAnnotation");for(let s=0;s<g.length;s++){const e=g[s];if(e.dataset.start&&e.dataset.playerId){const n=i.get()[e.dataset.playerId]?.annotationStarts;n&&(n.push({start:Math.floor(Number(e.dataset.start)),end:Math.floor(Number(e.dataset.end))>Math.floor(Number(e.dataset.start))?Math.floor(Number(e.dataset.end)):void 0,playerId:e.dataset.playerId}),i.setKey(e.dataset.playerId,{...i.get()[e.dataset.playerId]||y,annotationStarts:n})),e.addEventListener("click",()=>{const r=e.dataset.playerId||"null",a=e.dataset.file;i.setKey(r,{...i.get()[r]||y,position:Number(e.dataset.start),seekTo:Number(e.dataset.start),isPlaying:a})})}}i.listen((s,e,n)=>{if(!n)return null;const r=n.split(".")[0],a=s[r],l=document.querySelector(`.eventContainer[data-player-id="${r}"]`);if(!l)return console.error(`No event container found for ${n}`),null;const d=l.querySelectorAll(".annotationNode"),c=l.querySelectorAll(".annotationTags"),u=a.annotationStarts?.filter(t=>t.playerId===n),f=u?.findIndex((t,o)=>typeof t.end=="number"?t.start<=a.position&&t.end>a.position:o<u.length-1?t.start<=a.position&&u[o+1].start>a.position:t.start<=a.position);if(typeof f=="number"&&f>=0){const t=d[f];if(t){if(a.autoScroll)if(a.isEmbed){const o=document.querySelector(`.videoAnnotationContainer[data-player-id="${n}"]`),p=t.offsetTop;o?o.scroll({top:p-o.clientHeight,behavior:"smooth"}):l.scroll({top:p-l.clientHeight/3,behavior:"smooth"})}else t.scrollIntoView({behavior:"smooth",block:"end"});t.classList.add(b)}for(let o=0;o<d.length;o++)o!==f&&d[o].classList.remove(b)}if(a.showTags!==e[r]?.showTags)if(a.showTags)for(let t=0;t<c.length;t++)m(c[t]);else for(let t=0;t<c.length;t++)h(c[t]);for(const t of d){const o=t.getAttribute("data-uuid");o&&a.filteredAnnotations.includes(o)?m(t):h(t)}});
